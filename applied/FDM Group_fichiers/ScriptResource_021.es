function OpenNewWindow(e,o,t,n,a,i,c,r){var l,s="";if(o.length>0&&(o=o.replace(/[^a-zA-Z0-9]+/g,"")),""!=i)s=i;else{switch(a.toUpperCase()){case"SIMPLE":s="resizable=yes,scrollbars=yes,menubar=no,status=no,toolbar=no"}switch(t.toUpperCase()){case"ALMOSTFULL":""!=s&&(s+=","),s+="resizable=yes,scrollbars=yes,top=20,left=20,width="+.95*screen.width+",height="+.9*screen.height;break;case"HALF":""!=s&&(s+=","),s+="resizable=yes,scrollbars=yes,top=20,left=20,width="+.95*screen.width+",height="+.5*screen.height;break;case"QUARTER":""!=s&&(s+=","),s+="resizable=yes,scrollbars=yes,top=20,left=20,width="+.95*screen.width+",height="+.25*screen.height;break;case"WEBMAILPOPUP":""!=s&&(s+=","),s+="resizable=yes,scrollbars=yes,width=800,height=700"}}switch(n.toUpperCase()){case"OPENONTOP":l=window.open(e,o,s);break;case"REFRESHMAINWINDOW":l=window;var p=!1;try{for(;!l.closed&&null!=l.opener&&l.opener.location.href;)l=l.opener,p=!0}catch(e){}!l.closed&&p?l.location=e:l=window.open(e,o,"")}if(c&&l.focus(),null!=l&&r)setTimeout((function(){window.close()}),1e3)}function OpenBoxMaximizeWindow(e){var o=$Eploy(".fancybox-iframe");if(o.length>0&&CanAccessFrame(o[0].contentWindow)){var t=o[0].contentWindow.location.href;""!=t&&(t=(t=(t=(t=(t=t.toLowerCase()).replace("modal=true","")).replace("autocloseopenbox=true","")).replace("openmode=fancybox","")).replace("&&","&").replace("&&","&").replace("&&","&").replace("?&","?"),e?window.open(t):window.location=t)}}function checkstr(e){return"string"==typeof e&&(e.indexOf("%")>=0||e.indexOf("px")>=0||e.indexOf("em")>=0)?e:e+"px"}var refreshparentonclose=!1;function setFbSizeCss(e,o){if("inline"!==e.type&&(void 0===e.ignoreFBResize&&(e.ignoreFBResize=!1),void 0!==o&&!e.ignoreFBResize)){var t=o.toLowerCase();t.indexOf("editaction.aspx")>1||t.indexOf("editcalllog.aspx")>1||t.indexOf("editcorrespondence.aspx")>1||t.indexOf("editnote.aspx")>1?e.ITSTemplate="medium":t.indexOf("applicationdialog.aspx")>1?-1==t.indexOf("talentpool=true")?e.ITSTemplate="xl":e.ITSTemplate="ml":t.indexOf("editvacancyhistory.aspx")>1?(e.ITSTemplate="medium",e.showFullscreen=!1):t.indexOf("editvacancyhistory.asp")>1?(e.ITSTemplate="ml",e.showFullscreen=!0):t.indexOf("companysummary1.asp")>1||t.indexOf("vacancysummary1.asp")>1||t.indexOf("contactsummary1.asp")>1||t.indexOf("candidatesummary1.asp")>1?(e.ITSTemplate="xl_2",e.showFullscreen=!0):t.indexOf("uploadfile.aspx")>1&&(e.ITSTemplate="medium",e.maxHeight="700px")}var n={};if(e.hasOwnProperty("ITSTemplate"))switch(e.ITSTemplate){case"small":$Eploy.extend(n,{width:"100%","max-width":"600px",height:"calc(100% - 88px)","max-height":void 0!==e.maxHeight?checkstr(e.maxHeight):null});break;case"medium":$Eploy.extend(n,{width:"100%","max-width":"900px",height:"calc(100% - 88px)","max-height":void 0!==e.maxHeight?checkstr(e.maxHeight):null});break;case"ml":$Eploy.extend(n,{width:"100%","max-width":"1280px",height:"100%"});break;case"large":$Eploy.extend(n,{width:"100%","max-width":"1440px",height:"100%"});break;case"xl":$Eploy.extend(n,{width:"calc(100% - 88px)","max-width":"2000px",height:"calc(100% - 24px)","min-height":"calc(100% - 24px)","max-height":"calc(100% - 24px)","margin-bottom":"0px","margin-top":"24px"});break;case"xl_2":$Eploy.extend(n,{width:"calc(100% - 88px)","max-width":"2000px",height:"calc(100% - 50px)","min-height":"calc(100% - 50px)","max-height":"calc(100% - 50px)","margin-bottom":"0px","margin-top":"50px"});break;case"custom":void 0!==e.width&&$Eploy.extend(n,{width:checkstr(e.width)}),void 0!==e.height&&$Eploy.extend(n,{height:checkstr(e.height)}),void 0!==e.maxWidth&&$Eploy.extend(n,{"max-width":checkstr(e.maxWidth)}),void 0!==e.maxHeight&&$Eploy.extend(n,{"max-height":checkstr(e.maxHeight)})}else $Eploy.extend(n,{width:void 0!==e.width?checkstr(e.width):"100%","max-width":void 0!==e.maxWidth?checkstr(e.maxWidth):"900px",height:void 0!==e.height?checkstr(e.height):"calc(100% - 88px)","max-height":void 0!==e.maxHeight?checkstr(e.maxHeight):null,padding:void 0!==e.padding?checkstr(e.padding):"15px"});return n}function getToolbarButtons(e){var o=[];return $Eploy.extend($Eploy.fancybox.defaults.btnTpl,{showOpenInTab:'<button class="fancybox-button fancybox-openintab" onclick="OpenBoxMaximizeWindow(true)"><i class="icon icon-open-in-new" style="color:#fff;"></i></a>',showFullscreen:'<button class="fancybox-button fancybox-fullscreen" onclick="OpenBoxMaximizeWindow(false)"><i class="icon icon-fullscreen" style="color:#fff;"></i></a>'}),"large"!=e.ITSTemplate&&"xl"!=e.ITSTemplate||(void 0===e.showFullscreen&&(e.showFullscreen,e.showOpenInTab),void 0===e.showOpenInTab&&e.showOpenInTab),void 0!==e.showFullscreen&&1==e.showFullscreen&&o.push("showFullscreen","showOpenInTab"),void 0!==e.showOpenInTab&&1==e.showOpenInTab&&o.push("showOpenInTab"),o.push("close"),o}function appendSlideClass(e,o){var t;return void 0!==o.ITSTemplate&&(t+=" its-c-fancybox  its-c-fancybox--"+o.ITSTemplate,"iframe"==o.type&&((e=e.toLowerCase()).indexOf("applications/applicationdialog.aspx")>-1&&(t+=" its-c-fancybox--appDialog"),(e.indexOf("calendar/default.aspx")>-1||e.indexOf("viewpopupscheduler.aspx")>-1)&&(t+=" its-c-fancybox--calendar"))),t}var fancyboxarray=[];function OpenBox(e,o,t){o=o||{},t=t||{};var n=window.top;o.isURLID&&(o.type="iframe"),o.OpenInside&&(n=window),n.$Eploy.fancybox.defaults.buttons=getToolbarButtons(o);var a=n.$Eploy("#fancybox-container");0===a.length&&(n.$Eploy("body").prepend("<div id='fancybox-container' />"),(a=n.$Eploy("#fancybox-container")).on("click",(function(e){e.stopPropagation()})));var i={src:e,type:o.type,parentEl:void 0!==o.parentEl?o.parentEl:a,smallBtn:!1,margin:[44,22],modal:void 0!==o.modal&&o.modal,animationEffect:!1,autoFocus:void 0!==o.autoFocus?o.autoFocus:"true",keyboard:void 0!==o.keyboard?o.keyboard:"true",touch:!1,idleTime:!1,iframe:{preload:!0,css:setFbSizeCss(o,e),attr:{title:o.title}},baseClass:appendSlideClass(e,o),onInit:function(e,o,n){"function"==typeof t.onInit&&t.onInit()},beforeLoad:function(e,o,n){"function"==typeof t.beforeLoad&&t.beforeLoad()},afterLoad:function(a){n.userCancelled=!1,setFramePanelSize(),"iframe"==o.type&&void 0===o.autoFocus&&$Eploy(".fancybox-iframe").attr("tabindex","-1").focus(),"xl"==o.ITSTemplate&&e.toLowerCase().indexOf("applications/applicationdialog.aspx")>-1&&(-1==e.toLocaleLowerCase().indexOf("talentpool=true")?showBgTemplate():showBgTemplate("talentpool")),"iframe"!==o.type&&setAriaLabel(o),"function"==typeof t.afterLoad&&t.afterLoad(a)},beforeShow:function(e,o,n){"function"==typeof t.beforeShow&&t.beforeShow()},afterShow:function(e,o,n){"function"==typeof t.afterShow&&t.afterShow()},beforeClose:function(e,o){var n=getActiveFbIframe();if(n&&("function"==typeof n.checkPageChanges3&&!n.checkPageChanges3()||"undefined"!=n.modifiedByOtherUser&&n.modifiedByOtherUser))return!1;if("function"==typeof t.beforeClose){var a=t.beforeClose();if(void 0!==a&&!a)return!1}return!0},afterClose:function(e,o,n){if("function"==typeof t.afterClose){var a=e.closeArgs||{};t.afterClose(a)}},onActivate:function(e,o,n){"function"==typeof t.onActivate&&t.onActivate()},onDeactivate:function(e,o,n){"function"==typeof t.onDeactivate&&t.onDeactivate()}},c=n.$Eploy.fancybox.getInstance();c?c.current.src instanceof jQuery?c.current.src[0].outerHtml!=e[0].outerHtml||n.$Eploy.fancybox.open(i):c.current.src==e||n.$Eploy.fancybox.open(i):n.$Eploy.fancybox.open(i)}function CloseFbs(e,o,t){self!==top&&window.top.CloseFbs(e,o,t),void 0!==t&&(window.top.userCancelled=t);var n=window.top.$Eploy(".fancybox-container");if("string"==typeof e&&"all"==e.toLowerCase()&&(e=n.length),n.each((function(o){if(o<e){var t=window.top.$Eploy(this);if("iframe"==(t=window.top.$Eploy(t).data("FancyBox")).current.type){if(!t.current.beforeClose())return!1;t.close()}else t.close()}})),o){var a=window.top.$Eploy.fancybox.getInstance();if(a){if("iframe"==a.current.type)getFancyboxContentWindow(a).location.reload()}else window.top.location.reload()}return window.top.userCancelled=!1,!1}function CloseBox(e,o,t){setTimeout((function(){window.top.CloseFbs(1,e,o)}),0)}function setFramePanelSize(){var e=getActiveFbIframe();if(e&&void 0!==e.$Eploy){var o=e.$Eploy(".its-o-modal__content");if(o.length){var t=o.siblings(),n=0;t.each((function(e){n+=$Eploy(this).outerHeight()}));var a=window.top.$Eploy.fancybox.getInstance().slides[0].$content.outerHeight();o.outerHeight(a-n),window.top.$Eploy(window).one("resize",(function(){setFramePanelSize()}))}}}function setInlinePanelSize(e){if(e.length){var o=e.siblings(),t=0;o.each((function(e){t+=$Eploy(this).outerHeight()}));var n=window.top.$Eploy.fancybox.getInstance().slides[0].$content.outerHeight();e.outerHeight(n-t),window.top.$Eploy(window).one("resize",(function(){setInlinePanelSize(e)}))}}function showBgTemplate(e){void 0!==e&&(e=e.toLowerCase());var o,t=getFancybox(0);o="talentpool"==e?"<div class='its-c-app its-c-app-dummy'><div class='its-c-app__candidate'></div></div>":"<div class='its-c-app its-c-app-dummy'><div class='its-c-app__candidate'></div><div class='its-c-app__application'></div><div class='its-c-app__process its-t-workflowtool-dark'></div></div>",t.slides[0].$content.find(".its-c-app-dummy").length||t.slides[0].$content.append(o)}function CheckOpenedInFanxybox(){return 0==getActiveFbIframe()?"false":"true"}function getActiveFbIframe(){var e=window.top.$Eploy.fancybox.getInstance();if(e){if("iframe"==e.current.type){var o=e.current.$content[0].firstChild.contentWindow;return!!CanAccessFrame(o)&&o}return!1}return!1}function CanAccessFrame(e){var o=+new Date+""+Math.random();try{return e[o]="hello","hello"===e[o]}catch(e){return!1}}function callFrameFunction(e,o){var t=null!=o?$Eploy(o.content):$Eploy(".fancybox-iframe");t.length>0&&CanAccessFrame(t=t[0].contentWindow)&&"function"==typeof t[e]&&t[e]()}function OpenCreateApplication(e,o,t,n){var a=e+"admin/Tools/ApplicationWorkflow/CreateApplications.aspx?&CandidateID="+o+"&VacancyID="+t;n&&(a=a+"&"+n),OpenBox(a,{type:"iframe",ITSTemplate:"small",maxHeight:"600px"})}function OpenVacancyApplicationDialog(e,o,t,n,a){n||(n={type:"iframe",ITSTemplate:"xl",showOpenInTab:!1}),a||(a={afterClose:function(){location.reload()}}),OpenBox(buildVacancyApplicationUrl(e,o,t),n,a)}function buildVacancyApplicationUrl(e,o,t){if(e){var n="",a="";return o&&o>0&&(n+="?applicationid="+o),t&&t.length>0&&(a+=n.length>0?"&":"?",a+=t),e+"admin/applications/applicationdialog.aspx"+n+a}}function getFancybox(e){try{var o=!1;if(window.top.$Eploy(".fancybox-container").each((function(t){t==e&&(o=window.top.$Eploy(this).data("FancyBox"))})),o)return o;throw new Error("No Fancybox returned")}catch(e){return}}function getFancyboxContentWindow(e){return!!e&&("iframe"==e.current.type&&e.current.$content[0].firstChild.contentWindow)}function ChangeBox(e,o){void 0!==e?(void 0===o&&(o=window.top.$Eploy.fancybox.getInstance()),o&&"iframe"==o.current.type&&(o.current.$content.removeAttr("style"),o.current.$content.css(setFbSizeCss(e)))):window.top.$Eploy.fancybox.getInstance().update()}function BeforeCloseMailMerge(e){var o={};o.guid=window.top.$Eploy(".fancybox-iframe").contents().find("#hidGuid").val(),$Eploy.ajax({contentType:"application/json; charset=utf-8",data:JSON.stringify(o),type:"POST",async:!0,url:e+"EployIncludes/Webservices/HelpfulFunctions.asmx/MailMergeCleanup"})}function OpenMailMergeQuick(e,o,t,n){OpenMailMerge({serverPath:e,recordTypeID:o,recordID:t,contactMethod:n})}function OpenMailMerge(options){var default_opts={serverPath:"/",filterName:"",recordTypeID:0,recordID:0,vacancyID:0,selfPost:"",filesArray:"",callbacks:null,selectionCsv:"",forceSelection:!1,forceSelectionPrompt:"",mergeType:"",workflowRecordTypeID:0,contactMethod:"Email"};if(options=$Eploy.extend(default_opts,options),options.forceSelection&&""==options.selectionCsv)alert(options.forceSelectionPrompt);else{0==options.vacancyID&&$Eploy.ajax({type:"GET",url:options.serverPath+"classes/AjaxFunctions.asp?Process=GETCURRENTVACANCYINFO",async:!1,dataType:"text"}).done((function(data){var currentVacObj=eval(data)[0];options.vacancyID=currentVacObj.VacancyID})),void 0!==options.selfPost&&""!=options.selfPost&&$Eploy.ajax({type:"POST",url:window.location,async:!1,data:"AjaxLoad=true&FilterOnly=true&"+GetFormPostData(options.selfPost),contentType:"application/x-www-form-urlencoded; charset=utf-8"});var url=options.serverPath+"popups/MailMerge.aspx?&CurrentVacancyID="+options.vacancyID+"&RecordTypeID="+options.recordTypeID+"&RecordID="+options.recordID+"&FilterName="+options.filterName+"&MergeType="+options.mergeType+"&WorkflowRecordTypeID="+options.workflowRecordTypeID+"&ContactMethod="+options.contactMethod;if(void 0!==options.filesArray&&""!=options.filesArray){var csv="";for(i=0;i<options.filesArray.length();i++)""!=csv&&(csv+=","),csv+=options.filesArray.GetArray(i);url+="&FilesArray="+csv}options.callbacks||(options.callbacks={}),options.callbacks.beforeClose=function(){var e=getActiveFbIframe();if(e&&"function"==typeof e.checkMailMergeChanges&&!e.checkMailMergeChanges())return!1;BeforeCloseMailMerge(options.serverPath)},OpenBox(url,{type:"iframe",ITSTemplate:"ml"},options.callbacks)}}function OpenWebsiteClick(e){-1==e.toUpperCase().indexOf("HTTP://")&&-1==e.toUpperCase().indexOf("HTTPS://")?window.open("http://"+e):window.open(e)}function setAriaLabel(e){void 0!==e.arialabelID&&window.top.$Eploy(".fancybox-container").attr("aria-labelledby",e.arialabelID)}function OpenSelectedItemsWindow(e,o,t){window.open(e,o,"top=20,left=20,menubar=yes,toolbar=yes,status=yes,resizable=yes,scrollbars=yes,width="+.95*screen.width+",height="+.5*screen.height).focus();var n,a;n=document.FilterForm.target,a=document.FilterForm.action,document.FilterForm.SelectList.value=t,document.FilterForm.target=o,document.FilterForm.action=e,document.FilterForm.submit(),document.FilterForm.target=n,document.FilterForm.action=a,AllowSubmit=!0}